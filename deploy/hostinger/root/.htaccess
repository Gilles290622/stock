RewriteEngine On

# Forcer HTTPS (Hostinger) — éviter boucles si proxy déjà en HTTPS
RewriteCond %{HTTPS} !=on [OR]
RewriteCond %{HTTP:X-Forwarded-Proto} !https
RewriteRule ^ https://%{HTTP_HOST}%{REQUEST_URI} [R=301,L]

# Redirection de la racine vers /stock/
RewriteCond %{REQUEST_URI} ^/$
RewriteRule ^$ /stock/ [R=302,L]

# Router /api/* de la racine vers /stock/api/index.php, en passant le segment
RewriteRule ^api/?(.*)$ stock/api/index.php?route=$1 [QSA,L]

# Couvrir explicitement /stock/api/* au niveau racine (sécurité)
RewriteRule ^stock/api/?(.*)$ stock/api/index.php?route=$1 [QSA,L]
